void function(global,exports,undefined){"use strict";var toCode=Function.prototype.call.bind(Function.prototype.toString),hasOwn=Object.prototype.hasOwnProperty,keystore=Object.create.bind(null,null),UNDEFINED={},hidden={enumerable:!1},cryoDesc={writable:!0,value:undefined};function isObject(o){return o!=null&&typeof o=="object"||typeof o=="function"}function isPrimitive(o){return o==null||typeof o!="object"&&typeof o!="function"}function provide(name,init){if(!exports[name]){var locker=new Locker(name);exports[name]=init(locker.wrapper(),locker.unwrapper())}}function cryostore(o){var descs={};return o=Object(o),(Array.isArray(o)?o:Object.keys(o)).forEach(function(name){name in o?descs[name]={value:o[name],writable:!0}:descs[name]=cryoDesc}),Object.preventExtensions(Object.create(null,descs))}var UID=function(){var keys=keystore();return function UID(){var key="$"+(Math.random()/1.1).toString(36).slice(2);return key in keys?UID():keys[key]=key}}();Function.prototype.name==null&&void function(){Object.defineProperty(Function.prototype,"name",{configurable:!0,get:function getFunctionName(){if(this===Function.prototype)return"Empty";var src=toCode(this);return src=src.slice(9,src.indexOf("(")),Object.defineProperty(this,"name",{value:src}),src}})}();var definer=function(){var nativeSrc=toCode(Object).replace(/\n/g,"\\n").replace("Object",'"+this.name+"'),code='return function toString(){ return "'+nativeSrc+'" }',toString={configurable:!0,writable:!0,value:Function(code)()};function nativeToString(fn){return!hasOwn.call(fn,"toString")&&fn.toString!==toString.value&&Object.defineProperty(fn,"toString",toString),fn}return{enumerable:!1,configurable:!0,writable:!0,define:function define(object,fn){this.value=fn,Object.defineProperty(object,fn.name,this),nativeToString(fn),this.value=null}}}();function Class(description){return this.proto={},Object.keys(description).forEach(function(key){typeof description[key]=="function"&&this.addMethod(key,description[key])},this),this.ctor}Class.prototype.addMethod=function addMethod(name,method){typeof name=="function"&&(method=name,name=method.name),definer.define(this.proto,method),name==="constructor"&&this.setConstructor(method)},Class.prototype.setConstructor=function setConstructor(Ctor){Ctor.prototype=this.proto,this.ctor=Ctor;var brand=this.brand="[object "+Ctor.name+"]";this.addMethod(function toString(){return brand})};var Locker=function(){var perObjectStorage=function(){var ownNames=Object.getOwnPropertyNames,globalUID=UID();return definer.define(Object,function getOwnPropertyNames(obj){var props=ownNames(obj);return hasOwn.call(obj,globalUID)&&props.splice(props.indexOf(globalUID),1),props}),function perObjectStorage(obj){if(hasOwn.call(obj,globalUID))return obj[globalUID];var store=keystore();if(Object.isExtensible(obj))return Object.defineProperty(obj,globalUID,{value:store}),store;throw Error("Storage for non-extensible objects not implemented yet")}}(),lockerSrc='"use strict"; return function(key){ if (key === hashkey) return lockbox; }';return new Class({constructor:function Locker(name){var privateUID=UID(),hashkey=keystore();this.name=name,this.unlocker=function unlocker(obj){var storage=perObjectStorage(obj);if(hasOwn.call(storage,privateUID))return storage[privateUID](hashkey);var lockbox=Object.create(null,{value:cryoDesc});return Object.defineProperty(storage,privateUID,{configurable:!0,value:Function("hashkey","lockbox",lockerSrc)(hashkey,lockbox)}),Object.preventExtensions(lockbox)}},get:function get(obj){return this.unlocker(obj).value},set:function set(obj,value){return this.unlocker(obj).value=value},wrapper:function wrapper(){var self=this;return function wrap(obj,value){self.unlocker(obj).value=value}},unwrapper:function unwrapper(){var self=this;return function unwrap(obj){var value=self.unlocker(obj).value;if(!value)throw new TypeError(self.name+" is not generic.");return value}}})}(),Item=new Class({constructor:function Item(key,value){this.key=key,this.value=value},key:null,value:null,valueOf:function valueOf(){return this.value}});provide("WeakMap",function(wrap,unwrap){function validate(key){if(isPrimitive(key))throw new TypeError("WeakMap keys must be objects")}return new Class({constructor:function WeakMap(){if(!(this instanceof WeakMap))return new WeakMap;wrap(this,new Locker)},get:function get(key){validate(key);var value=unwrap(this).get(key);return value===UNDEFINED?undefined:value},set:function set(key,value){validate(key),value===undefined&&(value=UNDEFINED),unwrap(this).set(key,value)},has:function has(key){return validate(key),unwrap(this).get(key)!==undefined},"delete":function delete_(key){validate(key);var weakmap=unwrap(this);return weakmap.get(key)!==undefined?(weakmap.set(key,undefined),!0):!1}})}),provide("HashMap",function(wrap,unwrap){var STRING="string",NUMBER="number",OTHER="other",others={"false":!1,"true":!0,"null":null,0:0};function uncoerce(type,key){switch(type){case STRING:return key;case NUMBER:return+key;case OTHER:return others[key]}}function isNegativeZero(n){return n===0&&Infinity/n===-Infinity}function validate(key){if(key==null)return OTHER;switch(typeof key){case"string":return STRING;case"number":return isNegativeZero(key)?OTHER:NUMBER;case"boolean":return OTHER;case"function":case"object":if(key instanceof String)return STRING;if(key instanceof Number)return isNegativeZero(key/=1)?OTHER:NUMBER;if(key instanceof Boolean)return OTHER;throw new TypeError("HashMap keys must be primitive")}}return new Class({constructor:function HashMap(){if(!(this instanceof HashMap))return new HashMap;var types=keystore();types.string=keystore(),types.number=keystore(),types.other=keystore(),wrap(this,types)},get:function get(key){return unwrap(this)[validate(key)][key]},set:function set(key,value){unwrap(this)[validate(key)][key]=value},has:function has(key){return key in unwrap(this)[validate(key)]},"delete":function delete_(key){var hash=unwrap(this)[validate(key)];return key in hash?(delete hash[key],!0):!1},keys:function keys(){var hash=unwrap(this),out=[];for(var type in hash)for(var key in hash[type])out.push(uncoerce(type,key));return out},values:function values(){var hash=unwrap(this),out=[];for(var type in hash)for(var key in hash[type])out.push(hash[type][key]);return out},items:function items(){var out=[];return this.iterate(function(value,key){out.push(new Item(key,value))}),out},iterate:function iterate(callback,context){var hash=unwrap(this);context=isObject(context)?context:global;for(var type in hash)for(var key in hash[type])callback.call(context,hash[type][key],uncoerce(type,key),this)},toObject:function toObject(){var out={};return this.iterate(function(value,key){out[key]=value}),out}})}),provide("Map",function(wrap,unwrap){return new Class({constructor:function Map(){if(!(this instanceof Map))return new Map;wrap(this,{0:new exports.HashMap,1:new exports.WeakMap,keys:[],values:[]})},get:function get(key){var map=unwrap(this);return map.values[map[+isObject(key)].get(key)]},set:function set(key,value){var map=unwrap(this),table=map[+isObject(key)],index=table.get(key);index===undefined?(table.set(key,map.keys.length),map.keys.push(key),map.values.push(value)):(map.keys[index]=key,map.values[index]=value)},has:function has(key){return unwrap(this)[+isObject(key)].has(key)},"delete":function delete_(key){var map=unwrap(this),table=map[+isObject(key)],index=table.get(key);return index===undefined?!1:(table.delete(key),map.keys.splice(index,1),map.values.splice(index,1),!0)},keys:function keys(){return unwrap(this).keys.slice()},values:function values(){return unwrap(this).values.slice()},items:function items(){var out=[];return this.iterate(function(value,key){out.push(new Item(key,value))}),out},iterate:function iterate(callback,context){var map=unwrap(this),keys=map.keys,values=map.values;context=isObject(context)?context:global;for(var i=0,len=keys.length;i<len;i++)callback.call(context,values[i],keys[i])}})}),provide("Set",function(wrap,unwrap){return new Class({constructor:function Set(){if(!(this instanceof Set))return new Set;wrap(this,new exports.Map)},add:function add(key){unwrap(this).set(key,!0)},has:function has(key){return unwrap(this).has(key)},"delete":function delete_(key){return unwrap(this).delete(key)},values:function values(callback,context){return unwrap(this).keys()},iterate:function iterate(callback,context){this.keys().forEach(callback,isObject(context)?context:global)}})})}(Function("return this")(),typeof exports=="undefined"?this:exports)